<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
  <title>Madhyapur Thimi Mayor Candidates</title>
  <style>
    #map {
      height: 100%;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    .castleInTheSky {
      position: fixed;
      top: 10px;
      right: 10px;
      border-radius: 8px;
      background-color: black;
      z-index: 999999999999999999;
      opacity: 0.7;
      color: white;
      padding: 20px;
      font-family: "Helvetica";
      font-size: small;
    }
    img {
      width: 30px;
      height: 30px;
      border-radius: 3px;
      vertical-align: middle;
    }
    .candidateInfo{
      padding: 10px;
    }
  </style>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB1KhyStJaLIvMb45u7GaKtHGlYp0Bx8Dg"></script>
  <script>

    var overlay;
    USGSOverlay.prototype = new google.maps.OverlayView();

    function initMap() {
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 14,
        center: {lat: 27.682048, lng: 85.381412},
      });

//      map.addListener('click', function(s) {
//        alert(s.latLng.lat() + ', ' + s.latLng.lng())
//      });

      var bounds = new google.maps.LatLngBounds(
        new google.maps.LatLng(27.667869846790886, 85.35158157348633),
        new google.maps.LatLng(27.7031737150271, 85.40745735168457)
      )

      var srcImage = 'https://lh3.googleusercontent.com/iALnj3W_EKz8wg-MBOh0kJO8tCQG_42Q1TdjZN94IkkFoA1d5XSEVfKAQvLECB1hUnubPoa28pkWilLmX7_T01zhQkw=s960';

      overlay = new USGSOverlay(bounds, srcImage, map);

      var wardLocations = [
        {position: {lat: 27.6775995007861, lng: 85.35810470581055}, title: 'Ward Number 1', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
        {position: {lat: 27.681095883537264, lng: 85.3692626953125}, title: 'Ward Number 2', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
        {position: {lat: 27.67364693334881, lng: 85.37818908691406}, title: 'Ward Number 3', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
        {position: {lat: 27.674407053577546, lng: 85.38848876953125}, title: 'Ward Number 4', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5 }},
        {position: {lat: 27.67805555705713, lng: 85.39552688598633}, title: 'Ward Number 5', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
        {position: {lat: 27.682692021061115, lng: 85.39535522460938}, title: 'Ward Number 6', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
        {position: {lat: 27.68565621457348, lng: 85.38402557373047}, title: 'Ward Number 7', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
        {position: {lat: 27.694396316737205, lng: 85.39029121398926}, title: 'Ward Number 8', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
        {position: {lat: 27.68155192521006, lng: 85.40213584899902}, title: 'Ward Number 9', map: map, icon: {path: google.maps.SymbolPath.CIRCLE, scale: 5}},
      ]

      var wardData = [
        {"madan": 1001, "kaway": 1606, ward: 1, voters: 2937},
        {"madan": 812, "kaway": 734, ward: 2, voters: 1791},
        {"madan": 1340, "kaway": 1471, ward: 3, voters: 3327},
        {"madan": 3032, "kaway": 1165, ward: 4, voters: 4775},
        {"madan": 33, "kaway": 29, ward: 5, voters: 4811},
        {"madan": 0, "kaway": 0, ward: 6, voters: 3149},
        {"madan": 0, "kaway": 0, ward: 7, voters: 3519},
        {"madan": 0, "kaway": 0, ward: 8, voters: 2891},
        {"madan": 0, "kaway": 0, ward: 9, voters: 2338},
      ]

      var totalMadan = 0, totalKaway = 0
      wardData.map(function (wardInfo){
        totalMadan += wardInfo.madan
        totalKaway += wardInfo.kaway
      })

      document.getElementById('madanVote').innerHTML = totalMadan
      document.getElementById('kawayVote').innerHTML = totalKaway

//      var infoWindows = wardData.map(function (wardInfo, index) {
//        const content = "<div><div>Ward " + (wardInfo.ward) + "</div>" +
//            "<div>Total Voters: " + wardInfo.voters + "</div>" +
//            "<div class='candidateInfo'><img src='http://202.166.220.247:90/Symbols/icon2.png' /> Madan Sundar Shrestha: " + wardInfo.madan + "</div>" +
//            "<div class='candidateInfo'><img src='http://202.166.220.247:90/Symbols/icon1.png' /> Asta Kumar Kaway: " + wardInfo.kaway + "</div>" +
//          "</div>"
//        return content
//      })

//      var markers = wardLocations.map(function(wardLocation, index) {
//        const marker = new google.maps.Marker(wardLocation)
//
//        marker.addListener('click', function() {
//          document.getElementById('castleInTheSky').innerHTML = infoWindows[index]
//        });
//
//        return marker;
//      })


    }

    function USGSOverlay(bounds, image, map) {

      this.bounds_ = bounds;
      this.image_ = image;
      this.map_ = map;
      this.div_ = null;
      this.setMap(map);
    }

    USGSOverlay.prototype.onAdd = function() {

      var div = document.createElement('div');
      div.style.borderStyle = 'none';
      div.style.borderWidth = '0px';
      div.style.position = 'absolute';

      var img = document.createElement('img');
      img.src = this.image_;
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.position = 'absolute';
      div.appendChild(img);

      this.div_ = div;

      var panes = this.getPanes();
      panes.overlayLayer.appendChild(div);
    };

    USGSOverlay.prototype.draw = function() {

      var overlayProjection = this.getProjection();

      var sw = overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());
      var ne = overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());

      var div = this.div_;
      div.style.left = sw.x + 'px';
      div.style.top = ne.y + 'px';
      div.style.width = (ne.x - sw.x) + 'px';
      div.style.height = (sw.y - ne.y) + 'px';
      div.style.opacity = 0.4
    };

    USGSOverlay.prototype.onRemove = function() {
      this.div_.parentNode.removeChild(this.div_);
      this.div_ = null;
    };

    google.maps.event.addDomListener(window, 'load', initMap);
  </script>
</head>
<body>
<div id="map"></div>
<div class="castleInTheSky" id="castleInTheSky">
  <div>
    <div>Mayor Candidates</div>
    <div class='candidateInfo'><img src='http://202.166.220.247:90/Symbols/icon2.png' /> Madan Sundar Shrestha: <span id="madanVote"></span></div>
    <div class='candidateInfo'><img src='http://202.166.220.247:90/Symbols/icon1.png' /> Asta Kumar Kaway: <span id="kawayVote"></span></div>
    <div style="font-size: xx-small">Disclaimer : The data shown in this web page is obtained from various online source. </div>
    <div style="font-size: xx-small">The data may not be accurate but is targeted to provide brief overview.  </div>
  </div>
</div>
</body>
</html>
